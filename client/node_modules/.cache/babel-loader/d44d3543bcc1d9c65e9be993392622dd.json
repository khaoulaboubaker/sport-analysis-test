{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\khaoula\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\khaoula\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\khaoula\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\khaoula\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\khaoula\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\khaoula\\\\videoServer\\\\client\\\\src\\\\components\\\\Upload\\\\Upload.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport { Progress } from 'reactstrap';\nimport { ToastContainer, toast } from 'react-toastify';\nimport { Redirect } from 'react-router-dom';\nimport 'react-toastify/dist/ReactToastify.css';\nimport './Upload.css';\nimport Navbar from '../Navbar/Navbar';\n\nvar Upload = /*#__PURE__*/function (_React$Component) {\n  _inherits(Upload, _React$Component);\n\n  function Upload() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Upload);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Upload)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      selectedVideos: null,\n      loaded: 0\n    };\n    return _this;\n  }\n\n  _createClass(Upload, [{\n    key: \"maxSelectFile\",\n    value: function maxSelectFile(event) {\n      var files = event.target.files;\n\n      if (files.length > 1) {\n        toast.error('Maximum 1 file is allowed');\n        event.target.value = null;\n        return false;\n      } else {\n        /*let err = '';\r\n        for (let i = 0; i < files.length; i++) {\r\n          if (files[i].size > 52428800) { // 50 MB\r\n            err += files[i].name + ', ';\r\n          }\r\n        }\r\n        if (err !== '') {\r\n          // error caught\r\n          event.target.value = null;\r\n          toast.error(err + \" is/are too large. Please select file size < 50Mb\");\r\n        }*/\n      }\n\n      return true;\n    }\n  }, {\n    key: \"fileChangeHandler\",\n    value: function fileChangeHandler(event) {\n      var files = event.target.files;\n\n      if (this.maxSelectFile(event)) {\n        this.setState({\n          selectedVideos: files,\n          loaded: 0\n        });\n      }\n    }\n  }, {\n    key: \"fileUploadHandler\",\n    value: function fileUploadHandler(event) {\n      var _this2 = this;\n\n      var data = new FormData();\n\n      for (var i = 0; i < this.state.selectedVideos.length; i++) {\n        data.append('file', this.state.selectedVideos[i]);\n      }\n\n      axios.post('http://127.0.0.1:3333/api/upload', data, {\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + JSON.parse(localStorage.getItem('token'))['access_token']\n        }\n      }, {\n        onUploadProgress: function onUploadProgress(ProgressEvent) {\n          _this2.setState({\n            loaded: ProgressEvent.loaded / ProgressEvent.total * 100\n          });\n        }\n      }).then(function (res) {\n        toast.success('Upload Successful');\n      }).catch(function (err) {\n        toast.error(\"Upload Fail with status: \".concat(err.statusText));\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (!localStorage.getItem('userTokenTime')) return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/signIn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 55\n        }\n      });\n      return /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Navbar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(ToastContainer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }\n      }, \"Upload Video\"), /*#__PURE__*/React.createElement(\"hr\", {\n        className: \"my-4\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"form\", {\n        method: \"post\",\n        name: \"videoUpload\",\n        action: \"/api/upload\",\n        id: \"#\",\n        encType: \"multipart/form-data\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-group files\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 15\n        }\n      }, \"Upload Your Videos Here\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"file\",\n        name: \"file\",\n        className: \"form-control\",\n        multiple: \"multiple\",\n        accept: \"video/*\",\n        onChange: this.fileChangeHandler.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(Progress, {\n        max: \"100\",\n        color: \"success\",\n        value: this.state.loaded,\n        className: \"mt-4 mb-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 15\n        }\n      }, isNaN(Math.round(this.state.loaded, 2)) ? 0 : Math.round(this.state.loaded, 2), \"%\"), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn btn-success btn-block\",\n        onClick: this.fileUploadHandler.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }\n      }, \"Upload Video\")))));\n    }\n  }]);\n\n  return Upload;\n}(React.Component);\n\nexport default Upload;","map":{"version":3,"names":["React","axios","Progress","ToastContainer","toast","Redirect","Navbar","Upload","state","selectedVideos","loaded","event","files","target","length","error","value","maxSelectFile","setState","data","FormData","i","append","post","headers","JSON","parse","localStorage","getItem","onUploadProgress","ProgressEvent","total","then","res","success","catch","err","statusText","fileChangeHandler","bind","isNaN","Math","round","fileUploadHandler","Component"],"sources":["C:/Users/khaoula/videoServer/client/src/components/Upload/Upload.js"],"sourcesContent":["import React from 'react';\r\nimport axios from 'axios';\r\nimport { Progress } from 'reactstrap';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport { Redirect } from 'react-router-dom';\r\n\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport './Upload.css';\r\nimport Navbar from '../Navbar/Navbar';\r\n\r\nclass Upload extends React.Component {\r\n  state = {\r\n    selectedVideos: null,\r\n    loaded: 0\r\n  }\r\n\r\n  maxSelectFile(event) {\r\n    let files = event.target.files;\r\n    if (files.length > 1) {\r\n      toast.error('Maximum 1 file is allowed');\r\n      event.target.value = null;\r\n      return false;\r\n    } else {\r\n      /*let err = '';\r\n      for (let i = 0; i < files.length; i++) {\r\n        if (files[i].size > 52428800) { // 50 MB\r\n          err += files[i].name + ', ';\r\n        }\r\n      }\r\n      if (err !== '') {\r\n        // error caught\r\n        event.target.value = null;\r\n        toast.error(err + \" is/are too large. Please select file size < 50Mb\");\r\n      }*/\r\n    }\r\n    return true;\r\n  }\r\n\r\n  fileChangeHandler(event) {\r\n    const files = event.target.files;\r\n    if (this.maxSelectFile(event)) {\r\n      this.setState({\r\n        selectedVideos: files,\r\n        loaded: 0\r\n      });\r\n    }\r\n  }\r\n\r\n  fileUploadHandler(event) {\r\n    const data = new FormData();\r\n    for (let i = 0; i < this.state.selectedVideos.length; i++) {\r\n      data.append('file', this.state.selectedVideos[i]);\r\n    }\r\n    axios.post('http://127.0.0.1:3333/api/upload', data, {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': 'Bearer ' + JSON.parse(localStorage.getItem('token'))['access_token']\r\n      }\r\n    }, {\r\n      onUploadProgress: ProgressEvent => {\r\n        this.setState({\r\n          loaded: (ProgressEvent.loaded / ProgressEvent.total * 100)\r\n        });\r\n      }\r\n    }).then(res => {\r\n      toast.success('Upload Successful');\r\n    }).catch(err => {\r\n      toast.error(`Upload Fail with status: ${err.statusText}`);\r\n    });\r\n  }\r\n\r\n  render() {\r\n   if (!localStorage.getItem('userTokenTime')) return <Redirect to=\"/signIn\" />\r\n    return (\r\n      <React.Fragment>\r\n        <Navbar />\r\n        <div className=\"container mt-5\">\r\n          <div className=\"form-group\">\r\n            <ToastContainer />\r\n          </div>\r\n          <h4>Upload Video</h4>\r\n          <hr className=\"my-4\" />\r\n\r\n          <form method=\"post\" name=\"videoUpload\" action=\"/api/upload\" id=\"#\" encType=\"multipart/form-data\">\r\n            <div className=\"form-group files\">\r\n              <label>Upload Your Videos Here</label>\r\n              <input\r\n                type=\"file\"\r\n                name=\"file\"\r\n                className=\"form-control\"\r\n                multiple=\"multiple\"\r\n                accept=\"video/*\"\r\n                onChange={this.fileChangeHandler.bind(this)} />\r\n              <Progress max=\"100\" color=\"success\" value={this.state.loaded} className=\"mt-4 mb-1\">\r\n                {isNaN(Math.round(this.state.loaded, 2)) ? 0 : Math.round(this.state.loaded, 2)}%\r\n              </Progress>\r\n              <button\r\n                type=\"button\"\r\n                className=\"btn btn-success btn-block\"\r\n                onClick={this.fileUploadHandler.bind(this)}>Upload Video\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Upload;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}